<?php	require_once '../config.php';	$firstcall = true;	$total_calls = 1;	$now_calling = 1;	$page = 1;	$user =  "LewDowskiCapitalLLC_apiuser";	$pass = "jLdz>PLy5&";	// this loop will run only if there are still some data left pulling from API	while(true){				if($now_calling > $total_calls){			break;		}				$url = 'https://api.preview.autoprocessor.com/V03/ApexInventoryService/SearchProductions?PageSize=100&PageNumber='.$page;		$ch = curl_init();		curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); 		curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 		curl_setopt($ch, CURLOPT_URL, $url);		curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);		curl_setopt($ch, CURLOPT_USERPWD, $user.":".$pass);		$res = curl_exec($ch);		$someArray = json_decode($res, true);				if($someArray['TotalCount'] > 0){						for($i=0;$i<count($someArray['Data']);$i++){								$performers = '';								if(isset($someArray['Data'][$i]['Performers'])){					for($p=0;$p<count($someArray['Data'][$i]['Performers']);$p++){						$performers += $conn->real_escape_string($someArray['Data'][$i]['Performers'][$p]['Name']).",";					}				}								$value = "'".$conn->real_escape_string($someArray['Data'][$i]['ProductionId'])."',				'".$conn->real_escape_string($someArray['Data'][$i]['ProductionName'])."',					'".$conn->real_escape_string($someArray['Data'][$i]['Venue']['Name'])."',					'".$performers."','".$conn->real_escape_string($someArray['Data'][$i]['TotalActiveTickets'])."',					'".$conn->real_escape_string($someArray['Data'][$i]['ProductionDateLocal'])."',					'".$conn->real_escape_string($someArray['Data'][$i]['StubhubProductionId'])."',					'".$conn->real_escape_string($someArray['Data'][$i]['Status'])."',					'".$conn->real_escape_string($someArray['Data'][$i]['ProductionDateUtc'])."',					'".$conn->real_escape_string($someArray['Data'][$i]['TotalActiveGroups'])."'";									 $sql = "INSERT INTO logitix_events(ProductionId, ProductionName, Venue, Performer, TotalActiveTickets, ProductionDateLocal, StubhubProductionId, status, ProductionDateUtc, TotalActiveGroups) VALUES ($value) 				ON DUPLICATE KEY UPDATE					ProductionId = '" .$conn->real_escape_string($someArray['Data'][$i]['ProductionId'])."', 					ProductionName = '" .$conn->real_escape_string($someArray['Data'][$i]['ProductionName'])."', 					venue = '" .$conn->real_escape_string($someArray['Data'][$i]['Venue']['Name'])."', 					Performer = '" .$performers."', 					TotalActiveTickets = '" .$conn->real_escape_string($someArray['Data'][$i]['TotalActiveTickets'])."', 					ProductionDateLocal = '" .$conn->real_escape_string($someArray['Data'][$i]['ProductionDateLocal'])."', 					StubhubProductionId = '" .$conn->real_escape_string($someArray['Data'][$i]['StubhubProductionId'])."', 					status = '" .$conn->real_escape_string($someArray['Data'][$i]['Status'])."', 					ProductionDateUtc = '" .$conn->real_escape_string($someArray['Data'][$i]['ProductionDateUtc'])."', 					TotalActiveGroups = '" .$conn->real_escape_string($someArray['Data'][$i]['TotalActiveGroups'])."'";					if(!$conn->query($sql)){					die('data wasn\'t saved due to error.'.$conn->error.' '.$sql);				}			}		}		if($firstcall){			$total_calls = round($someArray['TotalCount']/100);		}		$now_calling++;		$page++;				sleep(5);die;	}		$conn->close();?>